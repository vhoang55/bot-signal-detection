!function(t){t.vhoang=window.vhoang||{},t.vhoang.HoneypotDetector=class{constructor(t){this.config=Object.assign({honeypotSelector:"[data-honeypot]",reportUrl:"http://localhost:8080/api/honeypot/report",minHumanTimeMs:1500},t),this.startTime=Date.now(),this.nonce=crypto.randomUUID(),this.interactions={mouse:!1,keyboard:!1,focus:!1},this._bindEvents()}_bindEvents(){document.addEventListener("mousemove",(()=>this.interactions.mouse=!0),{once:!0}),document.addEventListener("keydown",(()=>this.interactions.keyboard=!0),{once:!0}),document.addEventListener("focusin",(()=>this.interactions.focus=!0),{once:!0})}analyzeForm(t){const n=[];t.querySelectorAll(this.config.honeypotSelector).forEach((t=>{t.value&&""!==t.value.trim()&&n.push("HONEYPOT_FIELD_FILLED")}));const e=Date.now()-this.startTime;return e<this.config.minHumanTimeMs&&n.push(FORM_SUBMITTED_TOO_FAST),this.interactions.mouse||this.interactions.keyboard||n.push("NO_HUMAN_INTERACTION"),{suspicious:n.length>0,reasons:n,elapsed:e,interactions:this.interactions}}_canonicalString(t){return[t.timestamp,t.nonce,t.userAgent,JSON.stringify(t.result)].join("|")}async _computeHash(t){const n=this._canonicalString(t),e=await crypto.subtle.digest("SHA-256",(new TextEncoder).encode(n));return Array.from(new Uint8Array(e)).map((t=>t.toString(16).padStart(2,"0"))).join("")}async report(t){if(!t.suspicious)return;const n={timestamp:Date.now(),nonce:this.nonce,userAgent:navigator.userAgent,result:t};n.integrityHash=await this._computeHash(n),fetch(this.config.reportUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}}}(window);